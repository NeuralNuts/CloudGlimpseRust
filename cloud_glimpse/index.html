<!DOCTYPE html>
<html lang="en">

    <head>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Learn WGPU</title>
        <style>
        </style>
    </head>

    <body>

        <input type="file" id="file-input" />
        <button id="load-button">Load File</button>

        <canvas id="bevy-canvas"></canvas>
        <!-- First, load the JavaScript module -->
        <script type="module" src="/pkg/cloud_glimpse.js"></script>

        <!-- Then, define the loadFile function -->
        <script type="module">
            import init from '/pkg/cloud_glimpse.js';
            import { main } from '/pkg/cloud_glimpse.js'; // Adjust the path as needed

            init().then(() => {
                console.log("WASM module loaded and initialized");

                // Register the click event handler for the button by its id
                const loadButton = document.getElementById('load-button');
                loadButton.addEventListener('click', async () => {
                    const input = document.getElementById('file-input');
                    if (!input.files.length) return;

                    const file = input.files[0];
                    const arrayBuffer = await file.arrayBuffer();

                    main(new Uint8Array(arrayBuffer));
                });
            }).catch(e => {
                console.error("Failed to initialize the WASM module:", e);
            });
        </script>
    </body>

</html>
